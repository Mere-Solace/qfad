{
  "permissions": {
    "allow": [
      "WebSearch",
      "Bash(.venv\\\\Scripts\\\\python.exe -m pytest:*)",
      "Bash(C:/Users/btm74.000/Projects/finance/.venv/Scripts/python.exe -m pytest:*)",
      "Bash(C:/Users/btm74.000/Projects/finance/.venv/Scripts/pip.exe show pydantic-settings)",
      "Bash(.venv/Scripts/python.exe:*)",
      "Bash(../.venv/Scripts/python.exe -m uvicorn:*)",
      "Bash(xargs:*)",
      "Bash(gh repo view:*)",
      "Bash(where.exe:*)",
      "Bash(export PATH=\"$PATH:/c/Program Files/GitHub CLI\")",
      "Bash(gh issue create --repo Mere-Solace/qfad --title \"Charts: move toolbar outside graph, auto-fit on zoom, cap date ranges to data\" --body \"$\\(cat <<''EOF''\n## Summary\nImprove Plotly chart UX across all graphs: relocate the toolbar, auto-scale on selection, and prevent navigation beyond available data.\n\n## Current State\n- Plotly modebar floats **inside** the chart area \\(top-right by default\\), overlapping data points\n- Buttons arranged in Plotly''s default clustered layout\n- When zooming into a region, Y-axis doesn''t auto-fit to the visible data range\n- Range selector buttons \\(3M, 1Y, 5Y, 10Y, All\\) and the range slider don''t respect actual data boundaries — user can drag/select into empty date ranges\n\n## Requirements\n\n### 1. Move toolbar outside the graph\n- Position the Plotly modebar **outside** the plot area so buttons never overlap data\n- Options to investigate:\n  - Use Plotly''s `modebar.orientation: ''v''` to make it vertical, positioned via CSS to the right of the chart\n  - Or build a custom toolbar component outside the `<Plot>` element that calls Plotly methods \\(`relayout`, `downloadImage`, etc.\\)\n  - Arrange buttons in a clean vertical line beside the chart\n- Apply globally via `plotlyDefaults.ts` so all charts benefit\n\n### 2. Auto-fit Y-axis on zoom/pan\n- When the user zooms into an X-axis range \\(via drag-select or range slider\\), the Y-axis should **auto-scale to fit only the visible data**\n- Plotly config: investigate `yaxis.autorange` behavior with `fixedrange: false`\n- May need `relayout` event handler to trigger Y-axis recalculation on X-axis change\n- This applies to all time-series charts \\(MultiSeriesChart, Dashboard charts, YieldCurve historical if added\\)\n\n### 3. Cap selectable date range to available data\n- Range selector buttons \\(3M, 1Y, 5Y, 10Y, All\\) should not extend before the earliest observation or after the latest\n- Range slider min/max should be bounded to actual data extent\n- When \"All\" is pressed, it should show exactly the full data range, not an arbitrary default\n- Use Plotly''s `xaxis.range` and `xaxis.rangeselector` configuration to enforce bounds\n- Apply to both the MultiSeriesChart component and any other chart with range controls\n\n## Files to touch\n- `frontend/src/components/charts/plotlyDefaults.ts` — modebar config, axis defaults\n- `frontend/src/components/charts/MultiSeriesChart.tsx` — range selector bounds, Y-axis autofit\n- `frontend/src/pages/Dashboard.tsx` — apply consistent config to dashboard charts\n- `frontend/src/pages/YieldCurve.tsx` — apply consistent config\n- Possibly add CSS for modebar positioning\n\n## Acceptance Criteria\n- [ ] Modebar buttons are outside the chart plot area in a clean vertical layout\n- [ ] Zooming into a date range auto-scales Y-axis to fit visible data\n- [ ] Range selector buttons respect actual data boundaries\n- [ ] Range slider cannot be dragged beyond available data\n- [ ] Changes apply consistently to all charts in the app\nEOF\n\\)\")",
      "Bash(gh issue create:*)",
      "Bash(gh issue view:*)",
      "Bash(npx tsc:*)",
      "Bash(node -e:*)",
      "Bash(gh issue close 3 --repo Mere-Solace/qfad --comment \"$\\(cat <<''EOF''\nCompleted. Changes made:\n\n**Modebar outside chart** \\(`plotlyDefaults.ts`, `index.css`\\):\n- `modebar.orientation: ''v''` makes toolbar vertical\n- Right margin increased \\(20→50\\) to accommodate it\n- CSS keeps buttons in margin area, not overlapping data\n\n**Y-axis auto-fit on zoom** \\(`MultiSeriesChart.tsx`\\):\n- `onRelayout` handler detects X-axis range changes\n- Scans visible data points to compute Y min/max \\(both y1 and y2 axes\\)\n- Calls `Plotly.relayout\\(\\)` with fitted range + 5% padding\n\n**Date range capped to data** \\(`MultiSeriesChart.tsx`\\):\n- `xaxis.range` set to `[minDate, maxDate]` from actual data\n- `rangeslider.range` also bounded to data extent\n- Range selector buttons \\(3M/1Y/5Y/10Y/All\\) work within data bounds\n- Zoom handler clamps to data bounds\n\n**Buffer fix** \\(`vite.config.ts`\\):\n- Resolved `buffer/` import error from plotly.js in Vite dev mode\n\nAll charts inherit the modebar changes via shared `darkLayout`/`defaultConfig`.\nEOF\n\\)\")",
      "Bash(gh issue reopen:*)",
      "Bash(powershell:*)",
      "Bash(xxd:*)",
      "Bash(dir:*)",
      "Bash(.venv/Scripts/python:*)"
    ]
  }
}
